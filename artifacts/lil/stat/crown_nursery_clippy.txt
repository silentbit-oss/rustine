warning: this could be a `const fn`
warning: the function has a cognitive complexity of (27/25)
warning: the function has a cognitive complexity of (32/25)
warning: the function has a cognitive complexity of (39/25)
warning: the function has a cognitive complexity of (29/25)
